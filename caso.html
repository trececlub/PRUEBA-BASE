<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Detalle del Caso | Soluciones Migratorias</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Barra superior -->
  <div class="topbar">
    <div style="display:flex; align-items:center; gap:12px;">
      <span>Plataforma exclusiva para clientes de Soluciones Migratorias</span>
      <div style="position:relative;">
        <button id="ddBtn" aria-expanded="false" aria-controls="dropdown">Más información ▼</button>
        <div id="dropdown" class="dropdown">
          Aquí podrá conocer cómo usar esta plataforma para revisar hitos del proceso, próximas fechas y notas relevantes del equipo legal.
        </div>
      </div>
    </div>
  </div>

  <!-- Header -->
  <header>
    <img src="logo.png" alt="Soluciones Migratorias - Logo">
  </header>

  <!-- Barra informativa -->
  <section class="promo">
    Nuestra página principal |
    <a href="https://solucionesmigratorias.us" target="_blank" rel="noopener">[Visitar sitio web]</a>
  </section>

  <!-- Sección principal -->
  <main style="flex:1 0 auto; padding:20px;">
    <nav style="margin-bottom:20px; font-size:14px;">
      <a href="index.html">Inicio</a> > <span>Detalle del Caso</span>
    </nav>

    <h1 style="margin-bottom:20px; color:var(--brand-blue);">Detalle del Caso</h1>

    <!-- Contenedor de resultados -->
    <section id="case-details">
      <!-- Tarjeta 1: Información del Cliente -->
      <div class="card">
        <h2>Información del Cliente</h2>
        <div id="cliente-info"></div>
      </div>

      <!-- Tarjeta 2: Fechas de Cortes y Estado de Pago -->
      <div class="card">
        <h2>Fechas de Cortes y Estado de Pago</h2>
        <div id="corte-pago-info"></div>
      </div>
    </section>

    <!-- Nueva sección de actualizaciones -->
    <section class="card" style="margin-top:24px;">
      <h2>Actualizaciones del Caso</h2>
      <div id="updates-info">
        <p>No hay actualizaciones registradas.</p>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <p>&copy; 2025 | Soluciones Migratorias</p>
  </footer>

  <!-- Scripts -->
  <script>
    // Dropdown
    const btn = document.getElementById('ddBtn');
    const dd = document.getElementById('dropdown');
    btn.addEventListener('click', ()=>{
      const open = dd.style.display === 'block';
      dd.style.display = open ? 'none' : 'block';
      btn.setAttribute('aria-expanded', String(!open));
    });

    // Leer código desde la URL
    const params = new URLSearchParams(window.location.search);
    const codigo = params.get('codigo');
    const prefijo = codigo ? codigo.substring(0,3) : null;

    // Configuración de Google Sheets (ejemplo)
    const SHEET_URLS = {
      "123": "https://sheetdb.io/api/v1/xxxxxxxx?sheet=casos"
    };

    async function cargarDatos(){
      if(!codigo || !prefijo || !SHEET_URLS[prefijo]){
        document.getElementById("case-details").innerHTML = "<p>No se encontraron datos para este código.</p>";
        return;
      }

      try {
        const res = await fetch(SHEET_URLS[prefijo]);
        const data = await res.json();

        // Ejemplo de simulación
        document.getElementById("cliente-info").innerHTML = `
          <p><strong>Cliente:</strong> Juan Pérez</p>
          <p><strong>Código de Caso:</strong> ${codigo}</p>
          <p><strong>Tipo de Proceso:</strong> Asilo</p>
          <p><strong>Abogado Asignado:</strong> Dra. Valeria García</p>
        `;

        document.getElementById("corte-pago-info").innerHTML = `
          <p><strong>Próxima Audiencia:</strong> 15/10/2025</p>
          <p><strong>Tribunal:</strong> Corte de Inmigración - Miami</p>
          <p><strong>Estado de Pago:</strong> Al día</p>
        `;

        // Actualizaciones (ejemplo dinámico)
        const updates = [
          { fecha: "01/09/2025", nota: "Se presentó documentación adicional al tribunal." },
          { fecha: "15/08/2025", nota: "Se programó la audiencia inicial." }
        ];

        if(updates.length > 0){
          document.getElementById("updates-info").innerHTML = updates.map(u =>
            `<p><strong>${u.fecha}:</strong> ${u.nota}</p>`
          ).join("");
        }

      } catch(e){
        document.getElementById("case-details").innerHTML = "<p>Error al cargar la información.</p>";
      }
    }

    cargarDatos();
  </script>
</body>
</html>
