<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Soluciones Migratorias | Consulta de Estado de Caso</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* Header más grueso y azul */
    header {
      background-color: #0a2a43;   /* azul corporativo */
      height: 140px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px 0;
    }
    header img { height: 100px; }

    /* Fondo azul y texto blanco en la sección de consulta */
    .intro {
      background-color: #0a2a43;
      color: #fff;
      padding: 2rem;
      text-align: center;
      border-radius: 8px;
    }
    .intro h1 { color: #fff; }
    .intro p { color: #f0f0f0; }

    /* Estilos del input de código */
    .code-block { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
    .prefix {
      background:#eef3fb; border:1px solid var(--border, #dfe3e8); color:#0a2a43;
      font-weight:700; padding:10px 12px; border-radius:10px; letter-spacing:1px;
      min-width:56px; text-align:center;
    }
    .code-inputs {
      display: grid; grid-template-columns: repeat(10, 36px); gap: 8px;
    }
    .code-inputs input {
      width: 36px; height: 44px; text-align: center; font-size: 18px; font-weight: 700;
      border: 1px solid var(--border, #dfe3e8); border-radius: 8px; outline: none;
    }
    .code-inputs input:focus { border-color: #0a2a43; box-shadow: 0 0 0 2px rgba(10,42,67,.15); }

    .btn.enabled { opacity: 1; cursor: pointer; }
    .btn { opacity:.6; cursor:not-allowed; }

    .field-hint a { margin-left: 6px; }

    /* Modal básico */
    .modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,.5); align-items:center; justify-content:center; padding:16px; }
    .modal-content { background:#fff; border-radius:14px; padding:24px; max-width:680px; }
    .btn-accept { margin-top:12px; }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <img src="logo2.png" alt="Soluciones Migratorias - Logo">
  </header>

  <!-- Barra informativa -->
  <section class="promo">
    Nuestra página principal |
    <a href="https://solucionesmigratorias.us" target="_blank" rel="noopener">solucionesmigratorias.us</a>
  </section>

  <!-- Sección principal -->
  <main style="flex:1 0 auto;">
    <section class="intro">
      <img src="logo.png" alt="Soluciones Migratorias - Logo" style="width:90px; margin:0 auto 14px;">
      <h1>Consulta el estado de tu caso</h1>
      <p>
        Bienvenido a la plataforma oficial de <strong>Soluciones Migratorias</strong>. Aquí podrás revisar de manera segura
        el avance de tu proceso, próximas audiencias, documentos clave y notas del equipo legal. Nuestro objetivo es
        mantenerte informado con claridad y oportunidad.
      </p>
    </section>

    <section class="card" aria-labelledby="ingreso-caso">
      <h2 id="ingreso-caso">Ingresa tu número de caso</h2>
      <p class="field-hint">
        <strong>Número de referencia</strong>
        <span class="required">*</span>
        <span style="margin-left:6px; font-size:12px; color:#666;">Formato: <code>IOE</code> + 10 dígitos (ej. <code>IOE0324567831</code>)</span>
      </p>

      <div class="code-block">
        <span class="prefix" aria-hidden="true">IOE</span>
        <div class="code-inputs" aria-label="Dígitos del código">
          <input type="text" maxlength="1" inputmode="numeric" aria-label="Dígito 1">
          <input type="text" maxlength="1" inputmode="numeric" aria-label="Dígito 2">
          <input type="text" maxlength="1" inputmode="numeric" aria-label="Dígito 3">
          <input type="text" maxlength="1" inputmode="numeric" aria-label="Dígito 4">
          <input type="text" maxlength="1" inputmode="numeric" aria-label="Dígito 5">
          <input type="text" maxlength="1" inputmode="numeric" aria-label="Dígito 6">
          <input type="text" maxlength="1" inputmode="numeric" aria-label="Dígito 7">
          <input type="text" maxlength="1" inputmode="numeric" aria-label="Dígito 8">
          <input type="text" maxlength="1" inputmode="numeric" aria-label="Dígito 9">
          <input type="text" maxlength="1" inputmode="numeric" aria-label="Dígito 10">
        </div>
      </div>

      <button id="btnEnviar" class="btn" disabled>CONSULTAR</button>

      <p class="info">
        <span aria-hidden="true">ℹ️</span>
        La información mostrada en esta plataforma es referencial. Los documentos y notificaciones
        oficiales seguirán siendo los emitidos por las autoridades competentes o enviados por nuestro equipo legal.
      </p>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <p>&copy; 2025 | Soluciones Migratorias</p>
  </footer>

  <!-- Modal de descargo de responsabilidad -->
  <div id="welcomeModal" class="modal" role="dialog" aria-labelledby="modalTitle" aria-modal="true">
    <div class="modal-content">
      <div>
        <h2 id="modalTitle">Aviso importante</h2>
        <p>
          Esta plataforma es un servicio de <strong>Soluciones Migratorias</strong> para brindar visibilidad del avance de tu caso.
          La información presentada tiene fines informativos y no reemplaza notificaciones oficiales ni comunicaciones directas
          de nuestro equipo. Ante cualquier duda, contáctanos por los canales autorizados.
        </p>
        <button id="btnAceptar" class="btn-accept">ACEPTAR</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    // ====== Manejo de inputs (10 dígitos) ======
    const inputs = document.querySelectorAll('.code-inputs input');
    const button = document.querySelector('#btnEnviar');

    function sanitizeToDigit(el){ el.value = el.value.replace(/\D/g,'').slice(0,1); }
    function getDigits(){ return Array.from(inputs).map(i=>i.value).join(''); }

    function updateButton(){
      const digits = getDigits();
      const ok = digits.length === 10 && /^\d{10}$/.test(digits);
      button.disabled = !ok;
      button.classList.toggle('enabled', ok);
    }

    // Rellena progresivo y navegación con teclas
    inputs.forEach((input, i) => {
      input.addEventListener('input', ()=>{
        sanitizeToDigit(input);
        if (input.value && inputs[i+1]) inputs[i+1].focus();
        updateButton();
      });
      input.addEventListener('keydown', (e)=>{
        if (e.key === 'Backspace' && !input.value && inputs[i-1]) inputs[i-1].focus();
        if (/ArrowLeft/i.test(e.key) && inputs[i-1]) inputs[i-1].focus();
        if (/ArrowRight/i.test(e.key) && inputs[i+1]) inputs[i+1].focus();
      });
    });

    // Pegar: soporta IOE########## o solo ##########
    document.querySelector('.code-block').addEventListener('paste', (e)=>{
      const txt = (e.clipboardData?.getData('text') || '').toUpperCase().trim();
      if (!txt) return;
      e.preventDefault();

      // Limpieza
      const alnum = txt.replace(/[^A-Z0-9]/g,'');
      let digits = '';

      if (/^IOE\d{10}$/.test(alnum)) {
        digits = alnum.slice(3); // quitar IOE
      } else {
        const onlyNums = alnum.replace(/\D/g,'');
        if (/^\d{10}$/.test(onlyNums)) digits = onlyNums;
      }

      // Rellenar si es válido
      if (digits) {
        inputs.forEach((inp, idx)=> inp.value = digits[idx] || '');
        if (inputs[digits.length-1]) inputs[digits.length-1].focus();
        updateButton();
      }
    });

    // Click consultar
    button.addEventListener('click', ()=>{
      const digits = getDigits();
      if (!/^\d{10}$/.test(digits)){
        alert('Número inválido. Deben ser 10 dígitos.');
        return;
      }
      const fullCode = `IOE${digits}`;
      window.location.href = `caso.html?codigo=${fullCode}`;
    });

    // Modal bienvenida
    document.addEventListener('DOMContentLoaded', () => {
      const modal = document.getElementById('welcomeModal');
      const btnAceptar = document.getElementById('btnAceptar');
      modal.style.display = 'flex';
      btnAceptar.addEventListener('click', () => { modal.style.display = 'none'; });
    });
  </script>
</body>
</html>
